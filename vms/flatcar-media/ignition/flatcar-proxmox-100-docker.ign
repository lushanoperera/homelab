{"ignition":{"version":"3.4.0"},"passwd":{"users":[{"name":"core","sshAuthorizedKeys":["ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC1o+LR0vywznyrfJkK49RypPbFDZC/xORHCamB5SnZyGKs52Qv/j6B6itmZK1JeuEMm0uPRjcT5ASrmyTtJ3iw+xsOZ+xLMxK2lzOdEA5+wRb2GBT12489JXC6JK+zjUpfcW2aKvdcZtl/dFMUNbUHombALfh/70ivoKQuoMvBY+W+7fSs5KIibKZTMLtdtJ4z11jdITBBIPmELv8XroXVQuMgVftkEVOO//uDV9UNF4+xxjqLvQKkKdQnlnJK6DMqsDHLst9UvXb2we//g/JSXff3cdE088XiDZYXkvjYz+UCMHHGqbSzXEeWK+rtFtfbH7VRrKHQ9J/XI48n3auB lushano@MacBook-Pro-di-Lushano.local"]}]},"storage":{"files":[{"path":"/etc/systemd/network/10-static.network","contents":{"compression":"gzip","source":"data:;base64,H4sIAAAAAAAC/4r2TSxJzojl8kvMTbVNLckw4OKK9kstKc8vyo7lckxJKUotLrY1tDTSMzSz0DM0MABhfSMTLvfEktTyxEpUKS4Xv2AsIhZ6YMgFCAAA//8IwZvmbAAAAA=="},"mode":420},{"path":"/etc/modules-load.d/nfs.conf","contents":{"compression":"","source":"data:,nfs%0Anfsd%0Arpcsec_gss_krb5%0A"},"mode":420},{"path":"/opt/portainer/docker-compose.yml","contents":{"compression":"gzip","source":"data:;base64,H4sIAAAAAAAC/2yPQWvDMAyF7/kVppeeUhfaQ6c/E4StdaaOFSTFY/9+JIE4K7s8rO+9h6xKookLuPPt8jh3SlJTIIXOuYnFMBWSZXAujfgkaNTvrz4QZDRSW4OBy8aHguOxsbpCaigGbi6ZVHs1niaKq7ckddvmXO9Oj+v1CoucGvu432+wyMYq53mkQ2nfNkQ0BL/obvqK4mUuPnJ4kVyUwwv+g60xFvPlUwf9QqEIb/Pf3EgxIbTn6iqFWZL9DDxZ+2bhvtB3P0mqKdOTFExm6g7nvB2yNqOkSgIuc8Dc/QYAAP//LIGMkLwBAAA="},"mode":420},{"path":"/usr/lib/docker/cli-plugins/docker-compose","contents":{"source":"https://github.com/docker/compose/releases/download/v2.29.7/docker-compose-linux-x86_64"},"mode":493},{"path":"/opt/bin/install-nano.sh","contents":{"compression":"gzip","source":"data:;base64,H4sIAAAAAAAC/2RRTYsiMRC951e8bcVWlhB2jyKyy6gwJ+c25+p0SYLpVJOkbf33g+0cxLkU9erj8V7V7JdpfDQNZadmeI+5UAiIFAUXT9iJPXPC/9D7yLASC/nICctOEiNx8NQERnEUUURCI9eVylygeRD0vucT+aDUDG+JqfCDeUzU95zgI5x0jNYntkXSDcsx+TJRnnzgfMuFu5WyVLCFuc8aK4nNxLLZoN4fD7V69tA+BKchQuvUQfsCfUE1//jcVWszSjrnnixDj3hCNBlcByqcC7KDtqipP4PaFlpH0Zas+5a/NS1fTBxCwN/t4g8Wi0e9mv+ramg9JWp/PChlXSctfl9fxSvrZIy44/U9/Ogrtk5QvZxr+g63yIO1nPNpCOEGKq/blfoKAAD//7l0l/DXAQAA"},"mode":493},{"path":"/etc/systemd/system/mnt-nfs_shared.mount","contents":{"compression":"gzip","source":"data:;base64,H4sIAAAAAAAC/3SPQUvDQBCF7/sr8gO2aRLbWoU5KCJ4UA8qOYRQlmTSLG5mw8ykIf56acWDB4+PB997X/VBXmvzgNKwH9VHgpfHt2SIE2nSRU6kd4xtIhrZHdHcdYoMhDpH/lxFCp4wVcdHVFM6UvmnM9XzGVmbsncK+U2R5rt9mmdZerW/XZuyR0ZYD6Rr6uTwM2relxGBOtmY18s1AZ4tY3DqB7QnZIFNWlgW/4WQZ5v99npn5z+J3BCQoNhube+4tSNHjaDNaM+MCLsss4zKjgQKK9iALGIPhNriyZjqiURdCPVFDtv7BYYpqF9Ngvzr9h0AAP//HpfZgEQBAAA="},"mode":420},{"path":"/etc/systemd/system/hostname-fix.service","contents":{"compression":"gzip","source":"data:;base64,H4sIAAAAAAAC/2yPTUvDQBCG7/srhiBUD2kFj2EPFit4tRUPIYfpZmIGN7NhZyLpv5f4URR6m4+Xl+epX4StcQ+kIfNonMQ/8gx9UhMcCLgDJSvPu1L+4EDQIUd1951R9n8D65+A27K0ekiXn67ef0+NO5xG8klI+2RuN1PYG2bzmyPL5ojaQxlgpZFohLvbauGpayiurn87bwrwHoqYAsblVkDTVGA9yVkiWPwv0abwTrmCjlfumQZk+RLZzWze8rTwPYkaxti4VxSjdnvywxSNy0kprw3zG5n7DAAA//88AnYQPAEAAA=="},"mode":420},{"path":"/etc/tmpfiles.d/nfs-mounts.conf","contents":{"compression":"","source":"data:;base64,ZCAvbW50L25mc19zaGFyZWQgMDc1NSBjb3JlIGNvcmUgLQpkIC9tbnQvbWVkaWEgMDc1NSBjb3JlIGNvcmUgLQo="},"mode":420}]},"systemd":{"units":[{"enabled":true,"name":"docker.service"},{"enabled":true,"name":"qemu-guest-agent.service"},{"contents":"[Unit]\nDescription=Create mount directories\nBefore=mnt-nfs_shared.mount mnt-media.mount portainer-compose.service\n\n[Service]\nType=oneshot\nExecStart=/usr/bin/mkdir -p /mnt/nfs_shared /mnt/media /opt/portainer /opt/bin\nRemainAfterExit=true\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"create-mount-dirs.service"},{"enabled":true,"name":"mnt-nfs_shared.mount"},{"contents":"[Unit]\nDescription=NFS mount for media storage from winston\nRequires=network-online.target\nAfter=network-online.target\nBefore=docker.service media-stack-compose.service\n\n[Mount]\nWhat=192.168.100.38:/mnt/nfs_media\nWhere=/mnt/media\nType=nfs4\nOptions=rw,relatime,vers=4.2,rsize=1048576,wsize=1048576,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,_netdev\nTimeoutSec=300\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"mnt-media.mount"},{"contents":"[Unit]\nDescription=Install nano via Docker wrapper\nAfter=network-online.target docker.service\nWants=network-online.target\n\n[Service]\nType=oneshot\nExecStart=/opt/bin/install-nano.sh\nTimeoutStartSec=300\nRemainAfterExit=true\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"install-nano.service"},{"enabled":true,"name":"hostname-fix.service"},{"contents":"[Unit]\nDescription=Deploy Portainer via Docker Compose\nRequires=docker.service create-mount-dirs.service\nAfter=docker.service create-mount-dirs.service mnt-nfs_shared.mount mnt-media.mount\nWants=network-online.target install-nano.service\nAfter=network-online.target\n\n[Service]\nType=oneshot\nWorkingDirectory=/opt/portainer\nExecStart=/usr/bin/docker compose up -d\nExecStop=/usr/bin/docker compose down\nTimeoutStartSec=300\nRemainAfterExit=true\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"portainer-compose.service"},{"contents":"[Unit]\nDescription=Deploy Media Stack via Docker Compose\nRequires=docker.service mnt-media.mount\nAfter=docker.service mnt-media.mount\nWants=network-online.target\nAfter=network-online.target\n\n[Service]\nType=oneshot\nWorkingDirectory=/srv/docker/media-stack\nExecStartPre=/bin/sleep 10\nExecStart=/usr/bin/docker compose up -d\nExecStop=/usr/bin/docker compose down\nTimeoutStartSec=600\nRestart=on-failure\nRestartSec=30\nRemainAfterExit=true\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"media-stack-compose.service"},{"contents":"[Unit]\nDescription=Set hostname to docker\nBefore=systemd-hostnamed.service\n\n[Service]\nType=oneshot\nExecStart=/usr/bin/hostnamectl set-hostname docker\nRemainAfterExit=true\n\n[Install]\nWantedBy=multi-user.target\n","enabled":true,"name":"set-hostname.service"}]}}
